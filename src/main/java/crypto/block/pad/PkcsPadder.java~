package crypto.block.pad;

import java.util.Arrays;

public class PkcsPadder implements Padder {


    @Override
    public byte[] pad(byte[] data, int blockSize) {
        int len = data.length;
        if (len % blockSize == 0)
            return data;
        int paddingLength = blockSize - len % blockSize;
        byte[] padding = new byte[len + paddingLength];
        System.arraycopy(data, 0, padding, 0, len);
        // N 为需要填充的数量，末尾填充 N 个 N
        for (int i = 0; i < paddingLength; i++) {
            padding[len + i] = (byte) paddingLength;
        }
        return padding;
    }

    @Override
    public byte[] unpad(byte[] data, int blockSize) {
        int len = data.length;
        if (len % blockSize == 0)
            return data;
        System.out.println(data[len - 1]);
        int paddingLength = data[len - 1];
        return Arrays.copyOfRange(data, 0, len - paddingLength);
    }
}
